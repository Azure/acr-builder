TestPreProcessString : 
  Chaining :
    alias:
      values:
        a : a
        b : b
        c : c
        d : d
        e : e
        f : f
        g : g
        h : h
        i : i
        j : j
        k : k
        l : l
        m : m
        n : "n"
        o : o
        p : p
        q : q
        r : r
        s : s
        t : t
        u : u
        v : v
        w : w
        x : x
        y : "y"
        z : z

    $s$t$e$pT$i$m$e$o$u$t: 600
    $v$e$r$s$i$o$n: $v1.0.0

    $e$n$v:
      - "$f$o$o=$t$a$s$kE$n$v"

    $s$t$e$p$s:
      - $i$d: $p$u$l$l$e$r
        $c$m$d: $a$z$u$r$e/$i$m$a$g$e$s/$d$o$c$k$e$r $p$u$l$l $u$b$u$n$t$u
        $e$n$t$r$yP$o$i$n$t: $s$o$m$eE$n$t$r$yP$o$i$n$t
        $e$n$v: [$e$r$i$c=$f$o$o, $f$o$o=$b$a$r]
        $e$x$i$t$e$dW$i$t$h$o$u$t: [0, 255]
        $w$o$r$k$i$n$gD$i$r$e$c$t$o$r$y: $p$u$l$lD$i$r
        $r$e$t$r$i$e$s: 5
        $r$e$t$r$yD$e$l$a$y: 90
        $p$u$l$l: $t$r$u$e

      - $i$d: $b$u$i$l$d-$q$u$x
        $c$m$d: '$a$z$u$r$e/$i$m$a$g$e$s/$a$c$r-$b$u$i$l$d$e$r $b$u$i$l$d -$f D$o$c$k$e$r$f$i$l$e $h$t$t$p$s://$g$i$t$h$u$b.$c$o$m/$e$h$o$t$i$n$g$e$r/$q$u$x --$c$a$c$h$e-$f$r$o$m=$u$b$u$n$t$u'
        $w$h$e$n: ["-"]
        $d$e$t$a$c$h: $t$r$u$e
        $s$t$a$r$tD$e$l$a$y: 50

      - $i$d: C
        $c$m$d: $b$l$a$h
        $w$h$e$n: ["-"]
        $p$o$r$t$s:
          - "8000:8000"
          - "8080:8080"
        $e$x$p$o$s$e:
          - "80"
          - "81"
        $e$x$i$t$e$dW$i$t$h: [0, 1, 2, 3, 4]
        $k$e$e$p: $t$r$u$e
        $i$s$o$l$a$t$i$o$n: $d$e$f$a$u$l$t

      - $i$d: $b$u$i$l$d-$b$a$r
        $c$m$d: $a$z$u$r$e/$i$m$a$g$e$s/$a$c$r-$b$u$i$l$d$e$r $b$u$i$l$d -$f D$o$c$k$e$r$f$i$l$e $h$t$t$p$s://$g$i$t$h$u$b.$c$o$m/$e$h$o$t$i$n$g$e$r/$b$a$r --$c$a$c$h$e-$f$r$o$m=$u$b$u$n$t$u
        $w$h$e$n: ["-"]

      - $i$d: B
        $w$h$e$n: [C]
        $c$m$d: $a$z$u$r$e/$i$m$a$g$e$s/$g$i$t $c$l$o$n$e $h$t$t$p$s://$g$i$t$h$u$b.$c$o$m/$e$h$o$t$i$n$g$e$r/$c$l$o$n$e
        $i$g$n$o$r$eE$r$r$o$r$s: $t$r$u$e
        $d$i$s$a$b$l$eW$o$r$k$i$n$gD$i$r$e$c$t$o$r$yO$v$e$r$r$i$d$e: $t$r$u$e

      - $i$d: $b$u$i$l$d-$f$o$o
        $c$m$d: $a$z$u$r$e/$i$m$a$g$e$s/$a$c$r-$b$u$i$l$d$e$r $b$u$i$l$d -$f D$o$c$k$e$r$f$i$l$e $h$t$t$p$s://$g$i$t$h$u$b.$c$o$m/$e$h$o$t$i$n$g$e$r/$f$o$o --$c$a$c$h$e-$f$r$o$m=$u$b$u$n$t$u
        $e$n$v: ["$e$r$i$c=$f$o$o"]
        $w$h$e$n: [$b$u$i$l$d-$q$u$x]

      - $i$d: $b$u$i$l$d-$q$a$z
        $b$u$i$l$d: "-$f D$o$c$k$e$r$f$i$l$e $h$t$t$p$s://$g$i$t$h$u$b.$c$o$m/$e$h$o$t$i$n$g$e$r/$q$a$z --$c$a$c$h$e-$f$r$o$m=$u$b$u$n$t$u"
        $p$r$i$v$i$l$e$g$e$d: $t$r$u$e
        $u$s$e$r: $r$o$o$t
        $n$e$t$w$o$r$k: "$h$o$s$t"
        $r$e$p$e$a$t: 2
  Chaining Directive Changed :
    alias:
      values:
        a : a
        b : b
        c : c
        d : d
        e : e
        f : f
        g : g
        h : h
        i : i
        j : j
        k : k
        l : l
        m : m
        n : "n"
        o : o
        p : p
        q : q
        r : r
        s : s
        t : t
        u : u
        v : v
        w : w
        x : x
        y : "y"
        z : z
        $ : ^

    ^s^t^e^pT^i^m^e^o^u^t: 600
    ^v^e^r^s^i^o^n: ^v1.0.0

    ^e^n^v:
      - "^f^o^o=^t^a^s^kE^n^v"

    ^s^t^e^p^s:
      - ^i^d: ^p^u^l^l^e^r
        ^c^m^d: ^a^z^u^r^e/^i^m^a^g^e^s/^d^o^c^k^e^r ^p^u^l^l ^u^b^u^n^t^u
        ^e^n^t^r^yP^o^i^n^t: ^s^o^m^eE^n^t^r^yP^o^i^n^t
        ^e^n^v: [^e^r^i^c=^f^o^o, ^f^o^o=^b^a^r]
        ^e^x^i^t^e^dW^i^t^h^o^u^t: [0, 255]
        ^w^o^r^k^i^n^gD^i^r^e^c^t^o^r^y: ^p^u^l^lD^i^r
        ^r^e^t^r^i^e^s: 5
        ^r^e^t^r^yD^e^l^a^y: 90
        ^p^u^l^l: ^t^r^u^e

      - ^i^d: ^b^u^i^l^d-^q^u^x
        ^c^m^d: '^a^z^u^r^e/^i^m^a^g^e^s/^a^c^r-^b^u^i^l^d^e^r ^b^u^i^l^d -^f D^o^c^k^e^r^f^i^l^e ^h^t^t^p^s://^g^i^t^h^u^b.^c^o^m/^e^h^o^t^i^n^g^e^r/^q^u^x --^c^a^c^h^e-^f^r^o^m=^u^b^u^n^t^u'
        ^w^h^e^n: ["-"]
        ^d^e^t^a^c^h: ^t^r^u^e
        ^s^t^a^r^tD^e^l^a^y: 50

      - ^i^d: C
        ^c^m^d: ^b^l^a^h
        ^w^h^e^n: ["-"]
        ^p^o^r^t^s:
          - "8000:8000"
          - "8080:8080"
        ^e^x^p^o^s^e:
          - "80"
          - "81"
        ^e^x^i^t^e^dW^i^t^h: [0, 1, 2, 3, 4]
        ^k^e^e^p: ^t^r^u^e
        ^i^s^o^l^a^t^i^o^n: ^d^e^f^a^u^l^t

      - ^i^d: ^b^u^i^l^d-^b^a^r
        ^c^m^d: ^a^z^u^r^e/^i^m^a^g^e^s/^a^c^r-^b^u^i^l^d^e^r ^b^u^i^l^d -^f D^o^c^k^e^r^f^i^l^e ^h^t^t^p^s://^g^i^t^h^u^b.^c^o^m/^e^h^o^t^i^n^g^e^r/^b^a^r --^c^a^c^h^e-^f^r^o^m=^u^b^u^n^t^u
        ^w^h^e^n: ["-"]

      - ^i^d: B
        ^w^h^e^n: [C]
        ^c^m^d: ^a^z^u^r^e/^i^m^a^g^e^s/^g^i^t ^c^l^o^n^e ^h^t^t^p^s://^g^i^t^h^u^b.^c^o^m/^e^h^o^t^i^n^g^e^r/^c^l^o^n^e
        ^i^g^n^o^r^eE^r^r^o^r^s: ^t^r^u^e
        ^d^i^s^a^b^l^eW^o^r^k^i^n^gD^i^r^e^c^t^o^r^yO^v^e^r^r^i^d^e: ^t^r^u^e

      - ^i^d: ^b^u^i^l^d-^f^o^o
        ^c^m^d: ^a^z^u^r^e/^i^m^a^g^e^s/^a^c^r-^b^u^i^l^d^e^r ^b^u^i^l^d -^f D^o^c^k^e^r^f^i^l^e ^h^t^t^p^s://^g^i^t^h^u^b.^c^o^m/^e^h^o^t^i^n^g^e^r/^f^o^o --^c^a^c^h^e-^f^r^o^m=^u^b^u^n^t^u
        ^e^n^v: ["^e^r^i^c=^f^o^o"]
        ^w^h^e^n: [^b^u^i^l^d-^q^u^x]

      - ^i^d: ^b^u^i^l^d-^q^a^z
        ^b^u^i^l^d: "-^f D^o^c^k^e^r^f^i^l^e ^h^t^t^p^s://^g^i^t^h^u^b.^c^o^m/^e^h^o^t^i^n^g^e^r/^q^a^z --^c^a^c^h^e-^f^r^o^m=^u^b^u^n^t^u"
        ^p^r^i^v^i^l^e^g^e^d: ^t^r^u^e
        ^u^s^e^r: ^r^o^o^t
        ^n^e^t^w^o^r^k: "^h^o^s^t"
        ^r^e^p^e^a^t: 2
  Chaining Directive Unicode :
    alias:
      values:
        a : a
        b : b
        c : c
        d : d
        e : e
        f : f
        g : g
        h : h
        i : i
        j : j
        k : k
        l : l
        m : m
        n : "n"
        o : o
        p : p
        q : q
        r : r
        s : s
        t : t
        u : u
        v : v
        w : w
        x : x
        y : "y"
        z : z
        $ : 😎

    😎s😎t😎e😎pT😎i😎m😎e😎o😎u😎t: 600
    😎v😎e😎r😎s😎i😎o😎n: 😎v1.0.0

    😎e😎n😎v:
      - "😎f😎o😎o=😎t😎a😎s😎kE😎n😎v"

    😎s😎t😎e😎p😎s:
      - 😎i😎d: 😎p😎u😎l😎l😎e😎r
        😎c😎m😎d: 😎a😎z😎u😎r😎e/😎i😎m😎a😎g😎e😎s/😎d😎o😎c😎k😎e😎r 😎p😎u😎l😎l 😎u😎b😎u😎n😎t😎u
        😎e😎n😎t😎r😎yP😎o😎i😎n😎t: 😎s😎o😎m😎eE😎n😎t😎r😎yP😎o😎i😎n😎t
        😎e😎n😎v: [😎e😎r😎i😎c=😎f😎o😎o, 😎f😎o😎o=😎b😎a😎r]
        😎e😎x😎i😎t😎e😎dW😎i😎t😎h😎o😎u😎t: [0, 255]
        😎w😎o😎r😎k😎i😎n😎gD😎i😎r😎e😎c😎t😎o😎r😎y: 😎p😎u😎l😎lD😎i😎r
        😎r😎e😎t😎r😎i😎e😎s: 5
        😎r😎e😎t😎r😎yD😎e😎l😎a😎y: 90
        😎p😎u😎l😎l: 😎t😎r😎u😎e

      - 😎i😎d: 😎b😎u😎i😎l😎d-😎q😎u😎x
        😎c😎m😎d: '😎a😎z😎u😎r😎e/😎i😎m😎a😎g😎e😎s/😎a😎c😎r-😎b😎u😎i😎l😎d😎e😎r 😎b😎u😎i😎l😎d -😎f D😎o😎c😎k😎e😎r😎f😎i😎l😎e 😎h😎t😎t😎p😎s://😎g😎i😎t😎h😎u😎b.😎c😎o😎m/😎e😎h😎o😎t😎i😎n😎g😎e😎r/😎q😎u😎x --😎c😎a😎c😎h😎e-😎f😎r😎o😎m=😎u😎b😎u😎n😎t😎u'
        😎w😎h😎e😎n: ["-"]
        😎d😎e😎t😎a😎c😎h: 😎t😎r😎u😎e
        😎s😎t😎a😎r😎tD😎e😎l😎a😎y: 50

      - 😎i😎d: C
        😎c😎m😎d: 😎b😎l😎a😎h
        😎w😎h😎e😎n: ["-"]
        😎p😎o😎r😎t😎s:
          - "8000:8000"
          - "8080:8080"
        😎e😎x😎p😎o😎s😎e:
          - "80"
          - "81"
        😎e😎x😎i😎t😎e😎dW😎i😎t😎h: [0, 1, 2, 3, 4]
        😎k😎e😎e😎p: 😎t😎r😎u😎e
        😎i😎s😎o😎l😎a😎t😎i😎o😎n: 😎d😎e😎f😎a😎u😎l😎t

      - 😎i😎d: 😎b😎u😎i😎l😎d-😎b😎a😎r
        😎c😎m😎d: 😎a😎z😎u😎r😎e/😎i😎m😎a😎g😎e😎s/😎a😎c😎r-😎b😎u😎i😎l😎d😎e😎r 😎b😎u😎i😎l😎d -😎f D😎o😎c😎k😎e😎r😎f😎i😎l😎e 😎h😎t😎t😎p😎s://😎g😎i😎t😎h😎u😎b.😎c😎o😎m/😎e😎h😎o😎t😎i😎n😎g😎e😎r/😎b😎a😎r --😎c😎a😎c😎h😎e-😎f😎r😎o😎m=😎u😎b😎u😎n😎t😎u
        😎w😎h😎e😎n: ["-"]

      - 😎i😎d: B
        😎w😎h😎e😎n: [C]
        😎c😎m😎d: 😎a😎z😎u😎r😎e/😎i😎m😎a😎g😎e😎s/😎g😎i😎t 😎c😎l😎o😎n😎e 😎h😎t😎t😎p😎s://😎g😎i😎t😎h😎u😎b.😎c😎o😎m/😎e😎h😎o😎t😎i😎n😎g😎e😎r/😎c😎l😎o😎n😎e
        😎i😎g😎n😎o😎r😎eE😎r😎r😎o😎r😎s: 😎t😎r😎u😎e
        😎d😎i😎s😎a😎b😎l😎eW😎o😎r😎k😎i😎n😎gD😎i😎r😎e😎c😎t😎o😎r😎yO😎v😎e😎r😎r😎i😎d😎e: 😎t😎r😎u😎e

      - 😎i😎d: 😎b😎u😎i😎l😎d-😎f😎o😎o
        😎c😎m😎d: 😎a😎z😎u😎r😎e/😎i😎m😎a😎g😎e😎s/😎a😎c😎r-😎b😎u😎i😎l😎d😎e😎r 😎b😎u😎i😎l😎d -😎f D😎o😎c😎k😎e😎r😎f😎i😎l😎e 😎h😎t😎t😎p😎s://😎g😎i😎t😎h😎u😎b.😎c😎o😎m/😎e😎h😎o😎t😎i😎n😎g😎e😎r/😎f😎o😎o --😎c😎a😎c😎h😎e-😎f😎r😎o😎m=😎u😎b😎u😎n😎t😎u
        😎e😎n😎v: ["😎e😎r😎i😎c=😎f😎o😎o"]
        😎w😎h😎e😎n: [😎b😎u😎i😎l😎d-😎q😎u😎x]

      - 😎i😎d: 😎b😎u😎i😎l😎d-😎q😎a😎z
        😎b😎u😎i😎l😎d: "-😎f D😎o😎c😎k😎e😎r😎f😎i😎l😎e 😎h😎t😎t😎p😎s://😎g😎i😎t😎h😎u😎b.😎c😎o😎m/😎e😎h😎o😎t😎i😎n😎g😎e😎r/😎q😎a😎z --😎c😎a😎c😎h😎e-😎f😎r😎o😎m=😎u😎b😎u😎n😎t😎u"
        😎p😎r😎i😎v😎i😎l😎e😎g😎e😎d: 😎t😎r😎u😎e
        😎u😎s😎e😎r: 😎r😎o😎o😎t
        😎n😎e😎t😎w😎o😎r😎k: "😎h😎o😎s😎t"
        😎r😎e😎p😎e😎a😎t: 2
  
  Complex :
    test: 600
    stepTimeout: 600
    version: v1.0.0

    env:
      - "foo=taskEnv"

    steps:
      - id: puller
        cmd: azure/images/docker pull ubuntu
        entryPoint: someEntryPoint
        env: [eric=foo, foo=bar]
        exitedWithout: [0, 255]
        workingDirectory: pullDir
        retries: 5
        retryDelay: 90
        pull: true

      - id: build-qux
        cmd: 'azure/images/acr-builder build -f Dockerfile $qux --cache-from=ubuntu'
        when: ["-"]
        detach: true
        startDelay: 50

      - id: C
        cmd: blah
        when: ["-"]
        ports:
          - "8000:8000"
          - "8080:8080"
        expose:
          - "80"
          - "81"
        exitedWith: [0, 1, 2, 3, 4]
        keep: true
        isolation: default

      - id: build-bar
        cmd: acb build -f Dockerfile $bar --cache-from=ubuntu
        when: ["-"]

      - id: B
        when: [C]
        cmd: git clone https://github.com/ehotinger/clone
        ignoreErrors: true
        disableWorkingDirectoryOverride: true

      - id: build-foo
        cmd: acb build -f Dockerfile https://github.com/ehotinger/foo --cache-from=ubuntu
        env: ["eric=foo"]
        when: [build-qux]

      - id: build-qaz
        build: "-f Dockerfile https://github.com/ehotinger/qaz --cache-from=ubuntu"
        privileged: true
        user: root
        network: "host"
        repeat: 2
  Multiline Alias :
    alias :
      values:
        buildQux: |
          "id: build-qux
          cmd: 'azure/images/acr-builder build -f Dockerfile https://github.com/ehotinger/qux --cache-from=ubuntu'
          when: [\"-\"]
          detach: true
          startDelay: 50"
        C: |
          "id: C
          cmd: blah
          when: [\"-\"]
          ports:
            - \"8000:8000\"
            - \"8080:8080\"
          expose:
            - \"80\"
            - \"81\"
          exitedWith: [0, 1, 2, 3, 4]
          keep: true
          isolation: default"
        buildBar : |
          "id: build-bar
          cmd: azure/images/acr-builder build -f Dockerfile https://github.com/ehotinger/bar --cache-from=ubuntu
          when: [\"-\"]"
        Puller : |
          "id: puller
          cmd: azure/images/docker pull ubuntu
          entryPoint: someEntryPoint
          env: [eric=foo, foo=bar]
          exitedWithout: [0, 255]
          workingDirectory: pullDir
          retries: 5
          retryDelay: 90
          pull: true"
        B: |
          "id: B
          when: [C]
          cmd: azure/images/git clone https://github.com/ehotinger/clone
          ignoreErrors: true
          disableWorkingDirectoryOverride: true"
        buildFoo: |
          "id: build-foo
          cmd: azure/images/acr-builder build -f Dockerfile https://github.com/ehotinger/foo --cache-from=ubuntu
          env: [\"eric=foo\"]
          when: [build-qux]"
        buildQuaz : |
          "id: build-qaz
          build: \"-f Dockerfile https://github.com/ehotinger/qaz --cache-from=ubuntu\"
          privileged: true
          user: root
          network: \"host\"
          repeat: 2"
          
    stepTimeout: 600
    version: v1.0.0

    env:
      - "foo=taskEnv"

    steps:
      - $Puller
      - $buildQux 
      - $C
      - $buildBar
      - $B
      - $buildFoo
      - $buildQuaz

